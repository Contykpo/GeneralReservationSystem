@using GeneralReservationSystem.Web.Authentication
@using GeneralReservationSystem.Web.Services.Implementations.Authentication
@using GeneralReservationSystem.Web.Services.Interfaces.Authentication
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation
@inject IClientAuthenticationService ClientAuthenticationService
@inject AuthenticationStateProvider AuthStateProvider

<AuthorizeView>
    <Authorized>
        <MudNavLink OnClick="logout">Cerrar sesión</MudNavLink>
    </Authorized>
    <NotAuthorized>
        <MudNavLink Href="/login">Iniciar sesión</MudNavLink>
        <MudNavLink Href="/register">Registrarse</MudNavLink>
    </NotAuthorized>
</AuthorizeView>

@code {
    private async Task logout()
    {
        await ClientAuthenticationService.LogoutAsync();
        if (AuthStateProvider is CustomAuthenticationStateProvider custom)
        {
            custom.MarkUserAsLoggedOut();
        }
    }
}